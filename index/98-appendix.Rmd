
`r if(knitr:::is_latex_output()) '\\bapendices'`

```{r parametros, include = FALSE}

options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(echo = FALSE, cache = FALSE, message=FALSE, 
                      warning = FALSE, fig.ext='png', fig.align='center', 
                      fig.path = "images/", fig.pos = "H", dev = "png", 
                      dpi = 300, out.width = "100%")
```

<!--
If you feel it necessary to include an appendix, it goes here.
-->

\newcommand{\beginsupplement}{
  \setcounter{table}{0}  
  \renewcommand{\thetable}{A\arabic{table}} 
  \setcounter{figure}{0} 
  \renewcommand{\thefigure}{A\arabic{figure}}
}

\beginsupplement

# Supplementary Material - Chapter 2 {#appendix-a}

## Calculating opportunity cost

To estimate land opportunity cost, we have calculated the Net Present Value (NPV) of the main agricultural activities on each municipality from our study region, according to the Brazilian Institute of Geography and Statistics [@ibge_producao_2017]. The NPV is the sum of all cash flows within a determined period in the future, after applying a discount rate, and it is mainly used to determine if an investment will be profitable or will result in loss. It is calculated according to the following formula:

$$ NPV (i,N) = \sum^N_{t=0} \frac {benefits- costs} {(1+i)^t} $$
  
  
where the benefits are the cash inflows and the costs are the cash outflows of each activity, i is the discount rate and t is the time in the future, in years, for which the present value is being calculated.  After accessing the yield per municipality [@ibge_producao_2017], we have calculated the cash flow using production costs and gains from the mains crops [@conab_companhia_2017] and beef and milk production [@cepea_centro_2017] for each municipality for the year 2017. We have applied a discount rate of 8%, following interest rates practiced by agricultural credit financial institutes in Brazil, and previously used in similar studies [@niemeyer_planning_2019-1] and considered a time frame of 20 years, which is the time required by the Natural Vegetation Protection Law for restoration projects to be fully executed. The values were converted to US$ dollars using a convertion rate of 3.21414.

Following the calculation of the NPV, we have calculated the average NPV per municipality of crops and cattle farming weighted by the area of each activity. To spatialize this information, we have crossed the weighted average with the land-use map from 2017 (enfiar ref.!). Whenever the NPV assumed a negative value, we have adopted a conservative approach and transformed the value to 0. Because forestry only occupies 4% of the farms from our dataset, we have extended crops NPV for areas covered with forestry. We have also attributed a value of 0 for areas covered with natural vegetation. The resulting product is an opportunity cost map in dollars $ha^{-1}$ with 30m resolution, covering the entire study region (Figure \@ref(fig:cost)) 

## Bayesian models details

The analysis was conducted using the R package rstanarm [@gabry_rstanarm_2018], an appendage of the rstan [@guo_rstan_2019] package to execute  Markov Chain Monte Carlo. Each model was run with four independent Markov chains of 4000 iterations. The first 2000 was discarded as a warm-up. The model formulation and priors used in the models are presented below.

### Question 1: Drivers affecting the proportion of Legal Reserve declared

The response variable (R) in question 1 is a binary categorical variable representing the amount of Legal Reserve (LR) declared in each property. We divided the analyses into three parts, in which we had the following categories adjusted to the same independent variables: a-) no LR declared vs. LR declared; b -)  some LR allocated but below the legal requirement (LR proportion $>$0 and $<$0.18) vs. full LR requirement allocated  (LR proportion $\geq$ 0.18); c-) full LR allocated with no surplus (LR proportion $\geq$ 0.18 and $\leq$ 0.22) vs. LR surplus allocated (LR proportion $>$0.22). We have considered a different random intercept for each State where the properties are located (Minas Gerais or São Paulo).

$$ R  \sim \text{Binomial}{(1,p_i)}  $$
$$ logit (p_i) = \alpha_{ESTATE}[i] + (\beta{AS} + \beta{P}+\beta{Ir}+\beta{Div}+\beta{Tr}+\beta{OC}+\beta{APP}+\beta{A}+\beta{V})*p_i $$
$$ \alpha_{ESTATE[i]}\sim \text{Normal}{(0,10)} $$
$$ \beta{X_i}\sim \text{Normal}{(0,2.5)}$$

$AS$ = agricultural suitability index (0-1); $P$ = proportion of pasture at the farm; $Ir$= presence of central pivot irrigation; $Div$= diversity of land-uses index; $Tr$= transportation costs, in minutes; $OC$= opportunity cost, in dollars $ha^{-1}$; $APP$=  proportion of Areas of Permanent Protection;$A$= farm area, in hectares; $V$= proportion of natural vegetation.

### Question 2: Drivers affecting the location of LR

The response variable (R) in that case is a binary land-use (agriculture) or land-cover (natural vegetation) category or an LR ( vegetated LR or non-vegetated LR). We randomly sampled 2000 points within each LR class and land-use and land-cover category from our properties database and extracted the values of all independent variables in the models. We have also considered a different random intercept for each property where the land-use or land-cover point was located. For all comparisons, we adopted the agricultural area as the reference variable.

#### *Vegetation vs. agricultural area*

$$ R  \sim \text{Binomial}{(1,p_i)}  $$

$$ logit (p_i) = \alpha_{property}[i] + (\beta{AS} + \beta{Tr}+\beta{APP_d})*p_i $$
$$ \alpha_{property[i]}\sim \text{Normal}{(0,10)} $$

$$ \beta{X_i}\sim \text{Normal}{(0,2.5)}$$

#### *Vegetated LR  vs agricultural area*

$$ R  \sim \text{Binomial}{(1,p_i)}  $$
$$ logit (p_i) = \alpha_{property}[i] + (\beta{AS} + \beta{Tr}+\beta{APP_d})*p_i $$
$$ \alpha_{property[i]}\sim \text{Normal}{(0,10)} $$

$$ \beta{X_i}\sim \text{Normal}{(0,2.5)}$$

#### *Non-vegetated LR vs agricultural area*

$$ R  \sim \text{Binomial}{(1,p_i)}  $$
$$ logit (p_i) = \alpha_{property}[i] + (\beta{AS} +\beta{Tr}+\beta{APP_d}+\beta{OC}+\beta{V_d})*p_i $$
$$ \alpha_{property[i]}\sim \text{Normal}{(0,10)} $$
$$ \beta{X_i}\sim \text{Normal}{(0,2.5)}$$

$AS$ = agricultural suitability index (0-1); $Tr$= transportation costs, in minutes; $OC$= opportunity cost, in dollars $ha^{-1}$; $APP_d$=  Euclidean distance to Areas of Permanent Protection;$A$= farm area, in hectares; $V_d$= Euclidean distance to natural vegetation.


## Supplementary Figures

```{r cost, echo=FALSE, fig.align='center',out.width = '90%',fig.cap="Opportunity cost layer."}

library(knitr)

knitr::include_graphics("figure/cost.jpg")


```


```{r figureS1, echo=FALSE, fig.cap="Main land-uses-land-cover in the study region (>10.000 ha per municipality) from 1985 to 2015.  The data on crops and forest cover was collected in march 2019 from IBGE (Brazilian Institute of Geography and Statistics) and the data on pastures was obtained from MapBiomas collection 2.3 (http://mapbiomas.org).", fig.align='center'}

knitr::include_graphics("figure/figS1.jpg")

```

```{r figureS2,  echo=FALSE,fig.cap="Properties distributed among their Legal Reserve (LR) proportion for all 3,622 farms analyzed. There is an inflation on 0 and 0.2 values, so we have categorized LR proportion in four classes: no LR (proportion=0); LR deficit ( 0≤proportion<0.18); LR compliance  (0.18≤proportion≤0.22); LR surplus (proportion>0.22)"}

knitr::include_graphics("figure/figS2.jpeg")


```

```{r figureS3, echo=FALSE,fig.cap="Predicted probability of a farm to declare LR in contrast with farms that do not have any LR declared. The gray shade is the 95\\% confidence interval and the dotted red line represents a 50\\% probability.", fig.align='center'}

knitr::include_graphics("figure/figS3.jpg")


```

```{r figureS4, echo=FALSE,fig.cap="Predicted probability of a farm to declare the full LR area in contrast with having a LR proportion below the legal requirement inside the farm.  The gray shade is the 95\\% confidence interval and the dotted red line represents 50\\% probability.", fig.align='center'}

knitr::include_graphics("figure/figS4.jpg")


```

```{r figureS5, echo=FALSE,fig.cap="Predicted probability of a farm area to allocate LR surplus in contrast with having LR compliance only. The gray shade is the 95\\% confidence interval and the dotted red line represents 50\\% probability. ", fig.align='center'}

knitr::include_graphics("figure/figS5.jpg")


```

```{r figureS6, echo=FALSE,fig.cap="Predicted probability of a farm area to be covered with natural vegetation in contrast of have being converted to agriculture. The gray shade is the 95\\% confidence interval and the dotted red line represent 50\\% probability ", fig.align='center'}

knitr::include_graphics("figure/figS6.jpg")


```

```{r figureS7, echo=FALSE,fig.cap="Predicted probability of a farm area to be allocated as vegetated LRs in contrast with an agricultural area. The gray shade is the 95\\% confidence interval and the dotted red line represents 50\\% probability.", fig.align='center'}

knitr::include_graphics("figure/figS7.jpg")


```


```{r figureS8, echo=FALSE,fig.cap="Predicted probability of a farm area to be allocated as non-vegetated LRs in contrast with agricultural areas. The gray shade is the 95\\% confidence interval and the dotted red line represents 50\\% probability.", fig.align='center'}

knitr::include_graphics("figure/figS8.jpg")




```

\newcommand{\beginsupplement2}{
  \setcounter{table}{0}  
  \renewcommand{\thetable}{B\arabic{table}} 
  \setcounter{figure}{0} 
  \renewcommand{\thefigure}{B\arabic{figure}}
}

\beginsupplement2

# Supplementary Material - Chapter 3  {#appendix-b}

## Details on models construction and selection

<!--
reset counting and rename figures and tables
* ainda tem um erro, aparece parte do codigo

\newcommand{\beginsupplement2}{
  \setcounter{table}{0}  
  \renewcommand{\thetable}{B\arabic{table}} 
  \setcounter{figure}{0} 
  \renewcommand{\thefigure}{B\arabic{figure}}
}

-->





For the 16 farms which we collected yield data (60 kg bags $ha^(-1)$ per harvest) related to 92 coffee fields, we calculated a set of local and landscape metrics from different years between 2004-2018 (Supplementary Table B1): minimum distance to forest (in meters),  coffee field area (ha), coffee field perimeter-area ratio (m/m2), mean agricultural suitability of each coffee field [based on the index developed by Sparovek et al. -@sparovek_effects_2015], the coffee-forest edge density (m/m^2), the proportion of vegetation cover surrounding the coffee fields and the proportion of coffee surrounding the coffee fields. 

We calculated the landscape metrics (coffee and vegetation cover and the coffee-forest-edge density) on a multiscale circular buffer ranging from 100-1000m radius.      Then, for each variable, we fitted a simpler negative binomial regression model to select the scale with the highest likelihood (Supplementary Table B2). With the most suitable scales, we analyzed the colinearity among them to build the final models.  The edge density was highly correlated with coffee cover and the property area was correlated with the perimeter-area ratio so we did not include those variables in the same model. 

We fitted hierarchical Bayesian models allowing the intercept to vary among year and coffee fields      using a negative binomial distribution and uninformative priors. Each model was run with four independent Markov chains of 4000 iterations. The first 2000 was discarded as a warm-up. The model formulation and priors used in the models are presented below.

$$ yield/ha \sim \text{NB}( \mu_i, \phi)  $$

$$  log (\mu_i)  = \alpha_{FI[i]} + \alpha_{Y[j]} + \beta C_{1km} + \beta F_{1km}+ \beta C_{1km}: \beta F_{1km} + \beta F_{300m} + \beta PA + \beta S $$

$$ \alpha_{FI[i] \sim Nomral(\alpha,\sigma)}  $$
$$ \alpha_{Y[j] \sim Nomral(\alpha,\sigma)}  $$
$$ \alpha \sim Student =  t(3,3.7,2.5)  $$
$$ \sigma \sim Student =  t(3,0,2.5)  $$
$$ \beta (C_{1km},F_{1km},F_{300m}, CED_{1km}, PA, S) \sim flat  $$

$$ \phi \sim Gamma (0.01,0.01) $$

where $FI$ is the field, $Y$ is the year, $C$ is the proportion of coffee on 1 km buffer, $F_{1km}$ is the proportion of forest on 1 km buffer, $F_{300m}$ is the proportion of forest on 300 m buffer, $PA$ is the coffee field perimeter-area ratio $(m/m_2)$, CED is the coffe-forest edge density (m/$m^2$), $S$ is the agriculture suitability (0-1) and $i$ and $j$ are the identity of the field and the year from where yield data was collected.

We selected the final model by comparing the Leave-one-out cross-validation (LOO) of each of the above models. Model 1 had the lower estimated difference of expected leave-one-out prediction errors (Supplementary Table 3). We also tested whether the removal of the agriculture suitability would incur     a worse performance, which did not happen  so our final yield model is similar to model 1, without the agriculture suitability.

## Unexpected yield trends for regional-level scenarios

Contrary to our expectation, the regional-level approach led to a yield decrease when we target 30 and 40% forest cover.  Meta-analyses on the effects of agricultural diversification have previously identified both positive and negative yield responses [@tamburini_agricultural_2020; @karp_crop_2018].  Complex multitrophic interactions among natural enemies, pests, and crops might lead to more context-dependent situations [@karp_crop_2018; @libran-embid_effects_2017], for instance, in which pests are benefited rather than decrease with more surrounding natural vegetation, negatively affecting coffee yield. With such levels of complexity, we might not be able to fully explain this pattern. Nevertheless, we raise two possible complementary explanations. Firstly, regional scenarios induced more concentrated forest patches, favouring situations of high forest cover (>50%) and low coffee cover (<10%) (Supplementary Figure B4). Farms in a similar situation used to build our predictive yield model had lower yields (Supplementary Figure B2a), which can be a consequence of a lower productivity potential where they are located, resulting in higher forest cover. A similar pattern was described for coffee production at the Atlantic Forest, where municipalities with higher forest cover have higher coffee production up to a limit of around 30-40%, above which yield drops [@gonzalez-chaves_forest_2020]. Besides, a block-like configuration of forests reduces the flows of ecosystem services 6 if coffee and forests are distant. Secondly, those same farms used to build the model might have faced negative side-effects of increased pest damage associated with forests, affecting their yields. As a result, our model is penalizing coffee fields in situations of high forest cover and low coffee cover after the restoration.

## Supplementary Figures

```{r figureb1, out.width = "80%",echo=FALSE,fig.cap="Cost surface generated by the combination of opportunity cost and restoration cost. Restoration costs for the scenarios were estimated using a 30 m resolution raster containing the probability of natural regeneration or the necessity of actively planting seedlings7 and costs with restoration from projects within the Atlantic Rainforest8 .", fig.align='center'}

knitr::include_graphics("figure/costmap.jpg")




```



```{r figureb2, out.width = "100%",echo=FALSE,fig.cap="Cost and benefits used to calculate the final cash flow after the restoration interventions in each scenario. Opportunity cost with forgone production of non-coffee products divided by farm area (a);  restoration costs over 20 years divided by farm area; (b); total coffee area (c); coffee field yield estimated with our spatial yield model(d); total coffee production estimated with the yield model (e); net change in coffee production divided by farm area comparing the future scenarios with the baseline scenario (f); compensation costs divided by farm area for farms with forest cover < 20 \\% after the restoration intervention (g); compensation gains divided by farm area for farms with forest cover > 20 \\% after the restoration intervention (h). Cash values were converted to 2017 US dollars. Farm-level = fl; regional-level=rl."}


knitr::include_graphics("figure/panel_costbenefit.jpg")

```

```{r figureb3, out.width = "100%",echo=FALSE,fig.cap="Predicted yield values for the coffee fields in each scenario. Modelled Yield in function of the proportion of forest (x axis) and coffee (y axis) on a 1km circular buffer surrounding the coffee fields. Farm-level = fl; regional-level=rl."}

knitr::include_graphics("figure/predictedYield.jpg")


```

```{r figureb4, out.width = "80%",echo=FALSE,fig.cap="Average distance from coffee fields to forests. After generating the land use cover for the scenarios, we calculated the mean distance to forest areas ±1 standard error. Farm-level = fl; regional-level=rl."}

knitr::include_graphics("figure/av_dist.jpg")

```

```{r figureb5, out.width = "100%",echo=FALSE,fig.cap="Final yield model explanatory variables effect on yield. The interaction between the proportion of coffee and forest on a circular buffer surrounding coffee fields (a); the perimeter-area ratio of the coffee fields; and the local forest cover on a circular buffer around the coffee fields."}

knitr::include_graphics("figure/predYield_negbin_mod_simpl.jpg")

```

```{r figureb6, out.width = "100%",echo=FALSE,fig.cap="Farm’s cash flow distribution for each scenario. Cash values were converted to 2017 US dollars. Farm-level = fl; regional-level=rl."}

knitr::include_graphics("figure/cashflow_final.jpeg")

```

```{r figureb7, out.width = "100%",echo=FALSE,fig.cap="Comparison between muncipa lities within our study region and other municipalities in the Atlantic Forest growing coffee. Coffee fields are on average 33 \\% closer to forest patches (163.8m vs. 219.3m) in our region (a). Further, while in our region only C. arabica is grown, 16 \\% of the municipalities elsewhere grow C. canephora and in 12 \\% of them, C. canephora is predominant (b). Unlike Coffea arabica, C. canephora is self-sterile and might be more benefited by a higher abundance of pollinators 5 . The boxplots on show the lower quartile, the median, and the upper quartile of the data distribution.  Data from Gonzales-Chaves et al(2020). "}

knitr::include_graphics("figure/adrian_data.jpg")

```

\newpage

## Supplementary Tables

```{r  echo=FALSE, warning=FALSE}

tl <- read.csv("data\\talhoes.csv")

names(tl)[1] <- "Farm ID"
names(tl)[2:10] <- c(2006,2008,2009,2010,2013,2014,2015,2016,2018)

library(knitr)
library(kableExtra)


kbl(tl, caption = "Yield/ha data used to build the yield model. The columns correspond to the harvest year and the numbers bellow are the number of fields per farms (identified in the table with a number ID.) ",booktabs=T)%>%
  #kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = c("hold_position")) 



```

```{r  echo=FALSE, warning=FALSE}

iv <- read.csv("data\\indep_variables.csv",sep=";")

names(iv) <- c("variable","data generation","scale")

kbl(iv, caption = "Independent variables tested to fit the coffee yield model. We included variables in two different scales: local scale (lo) and landscape scale (ls). ",booktabs=T,"pipe",longtable=TRUE)%>%
  #kable_styling(latex_options = "striped") %>%
  kable_styling(latex_options = c("hold_position")) 

```

\newpage

<!--

apagar pra funcionar de novo essa porcaria

\KOMAoptions{paper=landscape,pagesize}
\recalctypearea
\section{}

-->



```{r echo=FALSE, warning=FALSE}

#library(stargazer)
# nao consigo por tabela na horizontal!

sv <- read.csv("data\\sel_variaveis_landscape.csv",sep=";")

sv[,c(2:12,14:17)] <- round(sv[,c(2:12,14:17)],3)

sv[is.na(sv) ] <- ""  



names(sv) <- c("M",	"Int.",	"100",	"200",	"300",	"400","500", "600"	, "700",	"800",	"900",	"1000"	,"df",	"logLik",	"AIC"	,"delta",	"weight")


library(kableExtra)

kbl(sv,format="latex" ,caption = "AIC table for the landscape variables tested to build the yield model. Models (M) are ranked by their likelihood for each variable tested (proportion of coffee, coffee-forest edges and proportion of forests). The variables were calculated on a multiscale circular buffer surrounding the coffee fields, ranging from 100-1000 meteres. Models with lower AIC were considered more plausible. Df – degrees of freedom; logLik – log likelihood; AIC – Akaike Information Criteria; delta is the diferrence between the AIC of the first ranked model and the rest. ",booktabs=T)%>%
#kable_styling(latex_options = "striped") %>%
 kable_styling(latex_options = c("hold_position","scale_down")) #%>%
 #landscape()




```

```{r echo=FALSE}
sb <-  read.csv("data\\sel_bayes.csv",sep=";")

names(sb) <- c("","elpd diff.","se diff")

kbl(sb,caption="Comparison among the final models tested. We compared the estimated difference of expected leave-one-out prediction errors (elpd diff) and their standard error difference (se diff). Model 1’ is similar to model 1, but without the agricultural suitability. ",booktabs=T,format="latex")%>%
  kable_styling(latex_options = c("hold_position"))

```


\newcommand{\beginsupplement2}{
  \setcounter{table}{0}  
  \renewcommand{\thetable}{C\arabic{table}} 
  \setcounter{figure}{0} 
  \renewcommand{\thefigure}{C\arabic{figure}}
}

\beginsupplement2

# Supplementary Material - Chapter 4  {#appendix-c}

## Supplementary Figures

```{r figurec1, out.width = "100%",echo=FALSE,fig.cap="Balance between matching covariates for properties within the Atlantic Forest. The farms were divided in large (267 - 8761 ha), medium (64  ha– 974 ha) and small farms (0.5 ha – 260 ha). Size ranges for small, medium or large properties are defined by the government at the municipal level, in accordance with intrinsic characteristics of the region. For this reason, there are overlaps between categories. The accumulated deforestation and regeneration are the sum of the deforestation and regeneration ratios between 2004-2009. The farms were also divided on the ones with no Legal Reserve (LR) and the ones with LR. We have also treated the proportion of pasture as categorical, using a threshold of 0.25 to divide them into low and high pasture proportion. The APP proportion is the proportion of  the farm’s area covered with areas of permanent protection. .", fig.align='center'}

knitr::include_graphics("figure/sup_smd_ma.jpeg")




```


```{r figurec2, out.width = "100%",echo=FALSE,fig.cap="Balance between matching covariates for properties within the Cerrado. The farms were divided in large (267 - 8761 ha), medium (64  ha– 974 ha) and small farms (0.5 ha – 260 ha). Size ranges for small, medium or large properties are defined by the government at the municipal level, in accordance with intrinsic characteristics of the region. For this reason, there are overlaps between categories. The accumulated deforestation and regeneration are the sum of the deforestation and regeneration ratios between 2004-2009. The farms were also divided on the ones with no Legal Reserve (LR) and the ones with LR. We have also treated the proportion of pasture as categorical, using a threshold of 0.25 to divide them into low and high pasture proportion. The APP proportion is the proportion of  the farm’s area covered with areas of permanent protection. .", fig.align='center'}

knitr::include_graphics("figure/sup_smd_ce.jpeg")




```


```{r figurec3, out.width = "50%",echo=FALSE,fig.cap="Observed annual trends for the proportion of vegetation cover at certified and non-certified properties. The distribution of values is illustrated by the grey dots and the average annual value by the red and blue dots, for non-certified and certified farms, respectively. The yellow shade is delimited by the minimum and median certification dates.", fig.align='center'}

knitr::include_graphics("figure/descriptive_figure_comfaixa_pveg.jpeg")




```


```{r figurec4, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of one year. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), and in the vegetation deficit outside APPs (c). The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_1year_ma.jpeg")




```


```{r figurec5, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of two years. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), and in the vegetation deficit outside APPs (c). The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_2year_ma.jpeg")




```



```{r figurec6, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of three years. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), and in the vegetation deficit outside APPs (c). The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_3year_ma.jpeg")




```



```{r figurec7, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Cerrado, considering an anticipation effect of one year. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), the vegetation deficit outside APPs (c), and the proportion of APP covered with natural vegetation between certified and non-certified farms. The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_1year_ce.jpeg")




```


```{r figurec8, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Cerrado, considering an anticipation effect of two years. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), the vegetation deficit outside APPs (c), and the proportion of APP covered with natural vegetation between certified and non-certified farms. The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_2year_ce.jpeg")




```

```{r figurec9, out.width = "100%",echo=FALSE,fig.cap="Average group-time treatment effect for properties within the Cerrado, considering an anticipation effect of three years. The red dots show the point estimates and 95 \\% confidence bands for the period pre-treatment. The blue dots show the point estimates and 95 \\% confidence bands for the period post-treatment. The figure shows the average effect in deforestation (a), natural regeneration (b), the vegetation deficit outside APPs (c), and the proportion of APP covered with natural vegetation between certified and non-certified farms. The x-axis represents the certification time: negative values are years before the certification and positive values are years after the certification, which is represented in time zero. Confidence bands crossing the zero on the y axis (red dotted line) are non-significant. Positive values mean that the treatment had a positive effect and negative values the opposite.", fig.align='center'}

knitr::include_graphics("figure/panel_antic_3year_ce.jpeg")




```


\newpage

## Supplementary Tables

```{r , echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)
library(dplyr)

matching_ma <- read_xlsx("data/matching_ma.xlsx") %>% 
  mutate_all(na_if,"")

matching_ma[,2:4] <- round(matching_ma[,2:4],4)

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(matching_ma, format ="latex",caption = "Covariates mean values and standard mean difference before (unmatched) and after the matching procedure (matching) for properties at the Atlantic Forest. The farms were divided in large (267 - 8761 ha), medium (64  ha– 974 ha) and small farms (0.5 ha – 260 ha)*. The accumulated deforestation and regeneration are the sum of the deforestation and regeneration ratios between 2004-2009. The farms were also divided on the ones with no Legal Reserve (LR) and the ones with LR. We have also treated the proportion of pasture as categorical, using a threshold of 0.25 to divide them into low and high pasture proportion. The APP proportion is the proportion of the farm’s area covered with areas of permanent protection.",booktabs = T,longtable=T) %>%
column_spec( 2, width = "2cm") %>%
column_spec( 1, width = "4cm") %>%
column_spec( 3, width = "2cm") %>%
column_spec( 4, width = "2cm") %>%
column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position")) %>%
footnote(c("* Size ranges for small, medium or large properties are classified by the government",
           " at the municipal level in accordance with their fiscal modules (minimum size of",
           " an economically viable area), following intrinsic characteristics of the region. The area  ",
           " range for the categories is as follows: 0.5 ha – 260 ha (small);",
           " 64 ha– 974 ha (medium); 267 - 8761 ha (large)."))




```
 

```{r , echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)
library(dplyr)

matching_ma <- read_xlsx("data/matching_ce.xlsx") %>% 
  mutate_all(na_if,"")

matching_ma[,2:4] <- round(matching_ma[,2:4],4)

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(matching_ma, format ="latex",caption = "Covariates mean values and standard mean difference before (unmatched) and after the matching procedure (matching) for properties at the Cerrado. The farms were divided in large (267 - 8761 ha), medium (64  ha– 974 ha) and small farms (0.5 ha – 260 ha)*. The accumulated deforestation and regeneration are the sum of the deforestation and regeneration ratios between 2004-2009. The farms were also divided on the ones with no Legal Reserve (LR) and the ones with LR. We have also treated the proportion of pasture as categorical, using a threshold of 0.25 to divide them into low and high pasture proportion. The APP proportion is the proportion of the farm’s area covered with areas of permanent protection.",booktabs = T,longtable=T) %>%
column_spec( 2, width = "2cm") %>%
column_spec( 1, width = "4cm") %>%
column_spec( 3, width = "2cm") %>%
column_spec( 4, width = "2cm") %>%
column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position")) %>%
footnote(c("* Size ranges for small, medium or large properties are classified by the government",
           " at the municipal level in accordance with their fiscal modules (minimum size of",
           " an economically viable area), following intrinsic characteristics of the region. The area  ",
           " range for the categories is as follows: 0.5 ha – 260 ha (small);",
           " 64 ha– 974 ha (medium); 267 - 8761 ha (large)."))




```
 
```{r , echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)
library(dplyr)

acc <- read_xlsx("data/acuracia.xlsx") %>% 
  mutate_all(na_if,"")

acc$accurary <- round(acc$accurary,2)


names(acc)[4] <- "accuracy(%)"

acc$`correct classification` <- round(acc$`correct classification`,0)


library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(acc, format ="latex",caption = "Accuracy results  of the land-use and land-cover classification at the property level. We generated 168 random points within the boundaries of the certified farms. Then, we performed a visual analysis comparing the Mapbiomas collection 5 classification with a RGB composition with Landsat TM 5 bands for the year 2007. When in doubt, we also used satellite images from Google Earth.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```
 
\newpage

```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

result_desmatamento_ma <- read_xlsx("data/desm_ma_pd.xlsx") %>% 
  mutate_all(na_if,"")

names(result_desmatamento_ma)[4:5] <-c("2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_desmatamento_ma, format ="latex",caption = "Deforestation average group-time treatment effect for properties within the Atlantic Forest: average treatment effect (ATT), standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```
 
 
 
```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

result_desmatamento_ce <- read_xlsx("data/desm_ce_pd.xlsx") %>% 
  mutate_all(na_if,"")

names(result_desmatamento_ce)[4:5] <-c("2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_desmatamento_ma, format ="latex",caption = "Deforestation average group-time treatment effect for properties within the Cerrado: average treatment effect (ATT), standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```
 

```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

result_reg_ma <- read.csv("data/reg_ma_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_reg_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_reg_ma, format ="latex",caption = "Regeneration average group-time treatment effect for properties within the Atlantic Forest: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```
 
```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

result_reg_ce <- read.csv("data/reg_ce_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_reg_ce) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_reg_ce, format ="latex",caption = "Regeneration average group-time treatment effect for properties within the Cerrado: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```


```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_def_ma <- read.csv("data/def_ma_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_def_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_def_ma, format ="latex",caption = "Vegetation deficit average group-time treatment effect for properties within the Atlantic Forest: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```


```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

result_def_ce <- read.csv("data/def_ce_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_def_ce) <-c("event time"," ATT","standard error","2.5%","97.5%") 


library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_def_ce, format ="latex",caption = "Vegetation deficit average group-time treatment effect for properties within the Cerrado: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


``` 

```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_app_ma <- read.csv("data/app_ma_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_app_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_app_ma, format ="latex",caption = "Areas of permanent protection vegetation cover average group-time treatment effect for properties within the Atlantic Forest: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```

```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_app_ma <- read.csv("data/deficit_ma_APP_l1_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_app_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_app_ma, format ="latex",caption = "Areas of permanent protection vegetation cover average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of one year: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```


```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_app_ma <- read.csv("data/deficit_ma_APP_l2_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_app_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_app_ma, format ="latex",caption = "Areas of permanent protection vegetation cover average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of two years: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```

```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_app_ma <- read.csv("data/deficit_ma_APP_l3_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_app_ma) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_app_ma, format ="latex",caption = "Areas of permanent protection vegetation cover average group-time treatment effect for properties within the Atlantic Forest, considering an anticipation effect of three years: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```


```{r echo=FALSE, warning=FALSE, message=FALSE,fig.align='center'}

library(readxl)
library(dplyr)

# result_def_ma <- read_xlsx("data/def_ma_pd.xlsx") %>% 
#   mutate_all(na_if,"")

result_app_ce <- read.csv("data/app_ce_pd.csv",sep=";") %>% 
  mutate_all(na_if,"")

names(result_app_ce) <-c("event time"," ATT","standard error","2.5%","97.5%") 

library(kableExtra)
library(xtable)
#names(tabela)[c(2,3)] <- c("Data generation","Question")
options(knitr.kable.NA = '')

kbl(result_app_ce, format ="latex",caption = "Areas of permanent protection vegetation cover average group-time treatment effect for properties within the Cerrado: average treatment effect (ATT), the standard error and the confidence error band aggregated by the length of exposure to certification (event time). Negative event time values represent the length in years before the certification and positive values the length in years after the certification. (*) – confidence band do not overlap zero.",booktabs = T,longtable=T) %>%
# column_spec( 2, width = "2cm") %>%
# column_spec( 1, width = "4cm") %>%
# column_spec( 3, width = "2cm") %>%
# column_spec( 4, width = "2cm") %>%
# column_spec( 5, width = "2cm") %>%
kable_styling(latex_options = c("repeat_header","hold_position"),position = "center") 


```



`r if(knitr:::is_latex_output()) '\\eapendices'`
